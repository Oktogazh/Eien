<%- include('templates/header.ejs'); -%>

  <!-- Page Heading -->
  <h1 class="mb-4 mt-4"><%= title %></h1>

    <!-- Stripe card -->
    <div class="col-lg-6">

      <div class="card shadow mb-4">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">Abonnez-vous des maintenant!</h6>
        </div>

        <div class="card-body">
          <% if (subscriptionActive) { %>
            <p>
              Merci de vous être abonné!
              N'oubliez pas de vous désabonner après avoir finis les podcasts!
            </p>

            <!-- Stripe cancelling subscription here -->
            <form action="/unsubscribe" method="post">
              <button class="btn btn-primary btn-xl js-scroll-trigger">Me désabonner</button>

            </form>

          <% } else { %>
              <p>Cette méthode se base sur six mois d'enregistrements quotidien, à seulement 10€ par mois.
              Il est temps pour vous de découvrir à quel point vous êtes doués pour apprendre de nouvelles langues.
              </p>

              <!-- Stripe API here -->
              <button onclick="gotoCheckout()" class="btn btn-primary btn-xl js-scroll-trigger">Je m'abonne ici!</button>

              <script src="https://js.stripe.com/v3/"></script>

              <script>
                var stripe = Stripe('<%= STRIPE_PUBLIC_KEY %>');
                function gotoCheckout() {
                  stripe.redirectToCheckout({
                    // Make the id field from the Checkout Session creation API response
                    // available to this file, so you can provide it as argument here
                    // instead of the {{CHECKOUT_SESSION_ID}} placeholder.
                    sessionId: '<%= sessionId %>'
                  }).then(function (result) {
                    // If `redirectToCheckout` fails due to a browser or network
                    // error, display the localized error message to your customer
                    // using `result.error.message`.
                  });
                };
              </script>
            <% } %>
          </div>
        </div>
      </div>

<%- include('templates/footer.ejs'); -%>
